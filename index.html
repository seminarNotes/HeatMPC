<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MPC HeatTreatment — Preject One-Page</title>

  <!-- MathJax configuration -->
  <script>
    window.MathJax = {
      tex: {
        inlineMath: [["$","$"], ["\\(", "\\)"]],
        displayMath: [["$$","$$"], ["\\[", "\\]"]]
      }
    };
  </script>
  
  <style>
    /* ===== Global Theme (Light) ===== */
    :root{
      --bg:#ffffff; 
      --ink:#0f172a; 
      --muted:#475569; 
      --rule:#e2e8f0; 
      --accent:#2563eb;
      --panel:#f8fafc; 
      --panel2:#fbfdff;
    }

    /* ===== Base Layout ===== */
    *{box-sizing:border-box}
    html,body{
      margin:0; padding:0;
      background:var(--bg); color:var(--ink);
    }
    body{
      font-family:'Noto Serif', ui-serif, Georgia, Cambria, 'Times New Roman', Times, serif;
      line-height:1.75;
    }
    a{color:var(--accent); text-decoration:none}
    .wrap{max-width:900px; margin:0 auto; padding:48px 28px}

    /* ===== Typography ===== */
    header{text-align:center; margin-bottom:8px}
    h1{font-size:28px; line-height:1.25; margin:0}
    .authors{margin-top:8px; color:var(--muted); font-size:15px}
    .affil{color:var(--muted); font-size:13px}
    .keywords,.meta{
      font-family:-apple-system,system-ui,Segoe UI,Roboto,'Apple SD Gothic Neo','Noto Sans KR',sans-serif;
      color:var(--muted);
    }
    .keywords{margin-top:8px; font-size:13px}
    .meta{margin-top:6px; font-size:12px}

    hr{border:none; border-top:1px solid var(--rule); margin:18px 0}

    section{margin:20px 0}
    h2{font-size:20px; margin:0 0 8px 0}
    h3{font-size:16px; margin:16px 0 6px}
    p{margin:10px 0}

    hr.divider {
      border: none;
      border-top: 1.5px solid #ccc;
      margin: 2.5rem 0;
    }

    /* ===== Components ===== */
    .abstract{
      border:1px solid var(--rule); background:var(--panel);
      border-radius:8px; padding:14px;
    }
    .toc{
      border:1px solid var(--rule); border-radius:8px;
      padding:12px; background:var(--panel2);
    }
    .toc ol{margin:0; padding-left:18px}

    figure{margin:12px 0}
    figcaption{color:var(--muted); font-size:13px}
    img,video{
      max-width:100%; border:1px solid var(--rule);
      border-radius:8px; background:transparent;
    }

    .refs li{margin:4px 0}

    .footer{
      margin-top:24px;
      font-family:-apple-system,system-ui,Segoe UI,Roboto,'Apple SD Gothic Neo','Noto Sans KR',sans-serif;
      font-size:12px; color:var(--muted); text-align:center;
    }

    /* ===== Common Button Style ===== */
    .btn{
      padding:8px 12px; 
      border-radius:10px; border:1px solid var(--rule);
      background:var(--panel2); color:var(--ink);
      cursor:pointer; font-size:13px;
    }
    .btn:hover{ filter:brightness(0.98) }

    /* ===== Link Bar ===== */
    .linkbar{
      display:flex; gap:10px; flex-wrap:wrap;
      justify-content:center; margin:10px 0 6px 0;
    }

    /* ===== Collapsible Content Box ===== */
    .detail-box{
      padding:15px; border-radius:8px; margin-top:10px;
      border:2px solid #000000; background:transparent;
    }
    .figure-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin: 20px 0;
    }

    .figure-grid img {
      width: 100%;
      height: auto;
    }
  </style>
</head>

<body>
  <div class="wrap">

    <!-- ===== Header ===== -->
    <header>
      <h1>열처리 공정용 ARX-ESO 기반 MPC 제어</h1>
      <div class="authors">Junhui Woo (Kyungpook National University)</div>
      <div class="affil">E-mail: junhui.woo.math@gmail.com</div> 

      <!-- NOTE: 기존 키워드 라인 유지(원본 표현 재사용). 필요 시 추후 정리 -->
      <div class="keywords">
        <strong>Keywords</strong> —
        Model Predictive Control (MPC),
        Data-driven Modeling,
        ARX Model,
        Extended State Observer (ESO),
        Thermal Process Control
      </div>
      
      <div class="meta"><strong>Project Period</strong>: <span id="proj-period">2025/11/13 - 2025/12/03</span></div>
      <div class="meta" id="last-updated">Last updated: —</div>
    </header>

    <hr/>

    <!-- ===== External Links ===== -->
    <div class="linkbar">
      <a class="btn" id="btnGithub" href="https://github.com/seminarNotes" target="_blank" rel="noopener">GitHub</a>
      <!--<a class="btn" id="btnPDF" href="./assets/paper.pdf" target="_blank" rel="noopener">PDF</a>
      <a class="btn" id="btnRepo" href="https://github.com/your-id" target="_blank" rel="noopener">Repository</a> -->
    </div>

    <!-- =========================================================
         (1) TL;DR
         ========================================================= -->
    <section id="summary">
      <h2>1. Summary</h2>

      <h3 id="proejct-summary">1.1 Project Summary</h3>
      <div class="abstract">
        <p>
          본 프로젝트는 열처리 공정에서 기존 PID 제어기를 데이터 기반 모델 예측 제어(MPC)로 대체하는 것을 목표로 한다.
          실제 공정에서는 약 ±5~10℃ 수준의 오차 허용 범위 내에서
          <b>930℃에서 3시간 유지 후 880℃에서 1시간 유지</b>라는
          명확한 품질 요구 조건을 만족해야 한다.
        </p>
        <p>
          이를 위해 실제 운전 데이터로부터 단순하면서도 MPC에 적합한
          ARX(1,1) 동적 모델을 식별하고,
          시간 지연, 냉부하, 열손실 등으로 인해 발생하는 모델 불일치를
          확장 상태 관측기(ESO)를 통해 외란으로 보정하는 구조를 설계하였다.
          최종적으로 ARX+ESO 기반 예측 모델을 사용하여
          입력 및 온도 제약을 만족하는 MPC 제어기를 구현하고,
          실제 데이터 기반 시뮬레이션을 통해 안정적인 제어 성능을 검증하였다.
        </p>
      </div>

      <h3 id="key-contribution">1.2 Key Contributions</h3>
      <ul>
        <li>실제 운전 데이터 기반 ARX(1,1) 모델 식별 및 검증</li>
        <li>시간 지연·냉부하 효과를 외란으로 흡수하는 ESO 설계</li>
        <li>입력·변화율·온도 제약을 고려한 MPC 제어 구조 안정화</li>
        <li>기존 기업 제공 MPC 코드의 문제점 분석 및 개선안 제시</li>
      </ul>
    </section>

    <hr>

    <!-- =========================================================
         Table of Contents (섹션/서브섹션 구조 반영)
         ========================================================= -->
    <section id="toc">
    <h2>Table of Contents</h2>
    <nav class="toc">
      <ol>
        <li><a href="#summary">Summary</a></li>
        <li><a href="#about-the-project">About the Project</a></li>
        <li><a href="#system-and-approach">System &amp; Approach</a></li>
        <li><a href="#control-design-framework">Control Design Framework</a></li>
        <li><a href="#results">Results</a></li>
        <li><a href="#insights">Insights</a></li>
        <li><a href="#references">References</a></li>
      </ol>
    </nav>
  </section>

    <hr>

    <!-- =========================================================
         (2) About the Project
         ========================================================= -->
    <section id="about-the-project">
      <h2>2. About the Project</h2>

      <!-- ===================================================== -->
      <h3 id="about-background">2.1 Problem Background</h3>

      <figure class="figure-grid">
        <img src="./assets/figure/plant.png" alt="Plant">
        <img src="./assets/figure/heat_controller.png" alt="heat_controller">
      </figure>
      

      <p>
        열처리 공정은 제품의 기계적 강도와 미세 조직을 결정하는 핵심 공정으로,
        챔버 내부 온도를 목표 값에 정확히 도달시키고 일정 시간 안정적으로 유지하는 것이 필수적이다.
        특히 실제 산업 현장에서는 공정 챔버에 물질이 투입되는 순간,
        내부 온도가 급격히 하강하는 <b>냉부하(cold load)</b> 현상이 반복적으로 발생한다.
      </p>

      <p>
        이러한 냉부하, 열손실, 시간 지연 등 비이상적인 요소는
        공정의 동특성을 비선형적이고 불확실하게 만들며,
        단일 고정 게인을 사용하는 기존 PID 제어기에서는
        오버슈트, 입력 포화, 불필요한 에너지 소모와 같은 문제가 빈번히 발생한다.
        특히 목표 온도가 단계적으로 변화하고,
        장시간 유지 구간이 포함된 열처리 공정에서는
        미래 거동을 고려하지 않는 제어 방식의 한계가 뚜렷하다.
      </p>

      <p>
        이러한 배경에서, 공정의 동적 특성을 예측 모델로 활용하고
        입력 및 설비 제약을 명시적으로 고려할 수 있는
        모델 예측 제어(MPC)는
        기존 PID 제어를 대체할 수 있는 유력한 대안으로 고려된다.
      </p>

      <!-- ===================================================== -->
      <h3 id="control-object">2.2 Control Objective</h3>

      <p>
        본 공정의 제어 목표는 챔버에 물질이 투입된 직후 발생하는 냉부하(cold load) 이후에도,
        제품 품질을 보장하는 허용 오차 범위(약 ±5~10&nbsp;℃) 내에서
        목표 온도를 안정적으로 추종하면서,
        공정 설비 제약을 만족하는 에너지 효율적인 열 공정 운전을 달성하는 것이다.
        이를 위해 제어기는 두 단계로 구성된 목표 온도 시나리오를 만족해야 한다.
        첫 번째 단계에서는 냉부하로 인해 하강한 챔버 온도를
        단시간 내에 <strong>930&nbsp;℃</strong>까지 상승시킨 후,
        온도 오차가 허용 범위 내에 유지되는 상태를
        <strong>180분(3시간)</strong> 동안 안정적으로 지속해야 한다.
        이후 두 번째 단계에서는 목표 온도를 <strong>880&nbsp;℃</strong>로 전환하고,
        동일한 허용 오차 조건 하에서
        <strong>60분(1시간)</strong> 동안 온도를 유지하는 것을 목표로 한다.
      </p>
      
      <p>
        본 시스템의 중요한 특징은 사전에 고정된 시간 스케줄을 따르지 않고,
        <strong>현재 온도가 목표 온도 범위 내에 일정 시간 동안 유지되었는지</strong>를 기준으로
        다음 목표로 자동 전환하는
        <em>목표 달성 기반 스케줄링(Achievement-Based Scheduling)</em>을 적용한다는 점이다.
        구체적으로,
      </p>
      
      <p style="text-align:center;">
        $$ |T_k - 930| \le \varepsilon $$
      </p>
      
      <p>
        조건이 연속적으로 180분 동안 만족되면 두 번째 목표 단계로 전환되며,
      </p>
      
      <p style="text-align:center;">
        $$ |T_k - 880| \le \varepsilon $$
      </p>
      
      <p>
        조건이 60분 동안 유지되면 전체 공정이 종료된다.
        이를 통해 외란이나 초기 조건 변화에 따라
        목표 전환 시점을 유연하게 결정할 수 있다.
      </p>
      
      <p>
        이와 동시에 제어기는 히터 출력 상한,
        입력 변화율 제한,
        최대 허용 온도와 같은 공정 설비 제약을 엄격히 만족해야 하며,
        과도한 제어 입력 변동을 억제하여
        에너지 소비를 최소화하는 입력을 계산하는 것을 핵심 목표로 한다.
        결과적으로 본 제어 목표는
        <strong>정확한 온도 추종 성능</strong>,
        <strong>외란에 대한 강인성</strong>,
        그리고 <strong>제약을 고려한 에너지 효율적 운전</strong>을
        동시에 달성하는 데 있다.
      </p>
      
      <!-- ===================================================== -->
      <h3 id="personal-contribution">2.3 Personal Contribution</h3>

      <h4>1) 기존 기업 제공 MPC 코드의 문제점 분석</h4>
      <p>
        기업 측에서 제공된 기존 MPC 구조는
        시간 지연과 냉부하 이벤트를 명시적으로 포함한 다음과 같은 모델을 기반으로 하고 있었다.
      </p>

      <p>
        $$ T_{k+1} = a T_k + b u_{k+d} + c + g L_k $$
      </p>

      <p>
        그러나 시간 지연을 포함한 모델은 MPC의 안정성 확보가 어렵고,
        냉부하 플래그 $L_k$는 실제 데이터의 노이즈와 불확실성을
        충분히 반영하지 못해 예측 오차가 누적되는 문제가 있었다.
      </p>

      <h4>2) 문제 해결을 위한 개선안 제시</h4>
      <p>
        이러한 문제를 해결하기 위해,
        본 프로젝트에서는 MPC에 보다 적합한
        단순한 ARX(1,1) 선형 모델
        $$ T_{k+1} = a T_k + b u_k $$
        을 예측 모델로 채택하였다.
      </p>

      <p>
        시간 지연, 냉부하, 열손실과 같이
        명시적 모델링이 어려운 요소는
        확장 상태 관측기(ESO)를 통해
        외란 항으로 추정·보정하는 구조를 제안하였다.
        이를 통해 모델 구조를 단순화하면서도
        실제 공정의 불확실성을 효과적으로 흡수할 수 있도록 하였다.
      </p>

      <h4>3) 개선안에 대한 시뮬레이션 검증</h4>
      <p>
        제안된 ARX(1,1)+ESO+MPC 구조는
        실제 운전 데이터를 기반으로 한 시뮬레이션을 통해 검증되었다.
        냉부하 발생 이후의 온도 회복 구간과
        장시간 유지 구간에서
        안정적인 추종 성능과 제약 만족 여부를 확인하였으며,
        기존 구조 대비 제어 안정성과 해석 용이성이 개선됨을 확인하였다.
      </p>
    </section>

    <hr>

    <!-- =========================================================
         (3) System & Approach
         ========================================================= -->
    <section id="system-and-approach">
      <h2>3. System &amp; Approach</h2>

      <h3 id="overall-pipeline">3.1 Overall Pipeline</h3>
      <figure>
        <img src="assets/figure/block_diagram.png" alt="Pipeline" />
      </figure>

      <p>
        전체 제어 시스템은 ARX(1) 모델, ESO, MPC가 결합된 폐루프 구조로 구성된다.
        현재 측정된 온도 $T_k$를 기반으로 ESO는 외란 $\hat{z}_k$를 실시간으로 추정하고,
        해당 값은 MPC 예측 모델에 직접 반영된다. MPC는 외란이 보정된 예측 모델을 사용하여
        입력 제약과 추종 성능을 동시에 만족하는 최적 입력 $u_k$를 계산한다.
        계산된 입력은 공정에 적용되며,
        다음 시점의 측정값을 통해 다시 ESO와 MPC가 갱신되는 구조를 따른다.
      </p>

      <h3 id="data-decription">3.2 Data Description</h3>
      <figure>
        <img src="./assets/figure/given_data.png" alt="Given_data">
      </figure>
      <p>
        본 연구에서는 실제 열처리 공정에서 수집된 운전 로그 데이터를 기반으로
        공정 모델 식별 및 제어기 성능 검증을 수행하였다.
        원시 데이터는 1분 주기의 CSV 로그 파일로,
        번호, 상태, 일자, 설비 정보, 품목 정보, 공정 온도, 전력량(kWh)로 구성되어 있다.
        이 중 모델링과 제어에 직접적으로 관련된 공정 온도와 전력 소비량만을 추출하여
        전처리를 수행하였다.
      </p>
      <p>
        온도 데이터에는 측정 오류로 인해 0으로 기록된 구간이 존재하였으며,
        이는 물리적으로 의미가 없으므로 선형 보간을 통해 보정하여
        상태 변수의 연속성을 확보하였다.
        제어 입력은 분당 전력 소비량을 기준으로 하여
        이를 kW 단위로 변환한 후,
        최대 전력 대비 비율로 정규화하여
        0과 1 사이의 무차원 입력으로 정의하였다.
      </p>
      <p>
        공정의 운전 특성을 반영하기 위해,
        온도 변화율과 절대 온도 수준을 기준으로
        전체 운전 구간을 세 개의 구간으로 구분하였다.
        온도 상승이 뚜렷하고 전력이 인가되는 구간을 승온 구간(I = 1),
        공정 온도가 910&nbsp;°C 이상으로 유지되는 구간을 고온 유지 구간(I = 2),
        그리고 온도가 860&nbsp;°C 이상 910&nbsp;°C 미만으로 감소하는 구간을
        냉각 구간(I = 3)으로 정의하였다.
        각 구간에는 시간 진행에 따라 0에서 1까지 증가하는
        정규화된 진행 변수 &lambda;를 부여하였다.
      </p>
      <p>
        모델 식별에는 전처리된 데이터 중
        승온 구간(I = 1)에 해당하는 데이터만을 사용하였다.
        해당 구간은 제어 입력 변화에 따른 온도 응답이 가장 명확하게 나타나,
        공정의 동특성을 식별하기에 적합하다.
        반면, 고온 유지 및 냉각 구간은
        식별된 모델의 검증과 MPC 제어 성능 평가에 활용하였다.
      </p>
    </section>

    <hr>

    <!-- =========================================================
         (4) Modeling
         ========================================================= -->
  <section id="control-design-framework">
    <h2>4. Control Design Framework</h2>

    <h3 id="control-oriented-model-strucuture">4.1 Control-Oriented Model Structure</h3>

    <p>
      본 프로젝트에서는 실제 열처리 공정을 대상으로
      제어기 설계를 위한 <em>control-oriented model</em>을 구성하였다.
      공정의 물리 모델을 상세하게 구성하기보다는,
      제어 성능과 계산 효율을 우선하여
      입력–출력 관계를 간결하게 표현할 수 있는
      선형 시불변(discrete-time LTI) 모델을 채택하였다.
    </p>

    <p>
      열처리 공정은 온도 변화가 매우 느리고,
      제어 입력(전력)에 대해 비교적 단순한 누적 효과를 가지는 특성이 있다.
      이러한 특성을 반영하여,
      과거 출력과 현재 입력만을 사용하는
      ARX(AutoRegressive with eXogenous input) 모델을 사용하였다.
      그중에서도 가장 기본적인 형태인 ARX(1,1) 구조를 적용하였다.
    </p>

    <p>
      시간 스텝 <i>k</i>에서의 공정 온도를 <i>T<sub>k</sub></i>,
      정규화된 제어 입력을 <i>u<sub>k</sub></i>라 할 때,
      ARX(1,1) 모델은 다음과 같이 표현된다.
    </p>

    $$
    T_{k+1} = aT_k + bu_k
    $$

    <p>
      여기서 계수 <i>a</i>는 공정의 관성을 나타내며,
      값이 1에 가까울수록 온도 변화가 느린 공정을 의미한다.
      열처리 공정의 특성상 <i>a</i>는 1에 근접할 것으로 기대된다.
      계수 <i>b</i>는 입력 전력이 온도 상승에 미치는 영향을 나타내며,
      이 값이 작을 경우 제어 입력에 대한 온도 응답이 둔해질 수 있다.
    </p>

    <p>
      이와 같이 단순한 모델 구조를 사용함으로써,
      이후 MPC 설계 단계에서 계산 복잡도를 낮추고,
      실시간 적용 가능성을 확보하는 것을 목표로 하였다.
    </p>

    <h3 id="parameter-identification">4.2 Parameter Identification</h3>

    <p>
      ARX(1,1) 모델의 계수 <i>a</i>, <i>b</i>는
      실제 공정 데이터를 기반으로 시스템 식별(System Identification)을 통해 추정하였다.
      전처리된 데이터 중,
      제어 입력 변화에 따른 온도 응답이 가장 명확하게 나타나는
      <strong>승온 구간</strong>의 데이터만을 식별에 사용하였다.
    </p>

    <p>
      이는 온도 유지 구간이나 냉각 구간에 비해,
      승온 구간이 공정의 동특성을 가장 잘 드러내며
      모델 파라미터 추정에 유리하기 때문이다.
    </p>

    <p>
      파라미터 추정은 최소자승법(Least Squares)을 기반으로 수행되었으며,
      다음과 같은 비용 함수를 최소화하도록 계수를 결정하였다.
    </p>

    $$
    \begin{align}
    (a^{*}, b^{*})
    &= \arg\min_{a,b}
    \sum_{k=0}^{N-1}
    \Big( T_{k+1} - aT_k - bu_k \Big)^2
    \end{align}
    $$

    <p>
      또한, 모델의 물리적 일관성과 안정성을 유지하기 위해
      파라미터에 대해 간단한 제약 조건을 적용하였다.
    </p>

    $$
    a_{\min} \le a \le a_{\max}, \quad
    b_{\min} \le b \le b_{\max}
    $$

    <p>
      본 실험에서는 열공정의 안정성과 관성 특성을 고려하여
      <i>a</i>는 0과 1 사이,
      <i>b</i>는 0 이상의 값을 갖도록 설정하였다.
      이러한 제약은 비현실적인 모델 추정을 방지하고,
      이후 MPC 설계 단계에서 안정적인 제어 성능을 확보하는 데 기여한다.
    </p>

    <p>
      식별된 모델은 이후
      외란 보상을 위한 상태 확장 및
      MPC 기반 제어기 설계의 기본 모델로 활용된다.
    </p>
  
    <!-- =========================================================
         4.3 Disturbance Compensation via ESO
         ========================================================= -->
    <h3 id="disturbance-compensation-using-extended-state-observer">4.3 Disturbance Compensation using Extended State Observer</h3>
  
    <p>
      앞서 식별한 ARX(1,1) 모델은 제어기 설계를 위한 간결한 공정 모델을 제공하지만,
      실제 열처리 공정에서는 모델링 오차, 외란, 공정 조건 변화 등으로 인해
      예측 오차가 누적될 수 있다.
      이러한 오차는 MPC의 예측 정확도를 저하시켜
      제어 입력이 과도해지거나 추종 성능이 저하되는 원인이 된다.
    </p>
  
    <p>
      이를 보완하기 위해 본 프로젝트에서는
      Extended State Observer(ESO)를 도입하였다.
      ESO는 모델로 설명되지 않는 모든 불확실성을
      하나의 외란 항(disturbance)으로 묶어
      실시간으로 추정하는 관측기이다.
      추정된 외란을 예측 모델에 직접 반영함으로써,
      MPC가 보다 실제 공정에 가까운 예측을 수행하도록 한다.
    </p>
  
    <p>
      식별된 ARX(1,1) 모델에 외란 상태 $z_k$를 추가하면,
      공정 모델은 다음과 같은 확장 상태 형태로 표현된다.
    </p>
  
    $$
    \begin{aligned}
    T_{k+1} &= aT_k + b u_k + z_k, \\
    z_{k+1} &= z_k
    \end{aligned}
    $$
  
    <p>
      여기서 $z_k$는 시간에 따라 천천히 변화하는 외란이라고 가정하여
      상수 상태로 모델링하였다.
      이 외란은 환경 변화, 열 손실, 모델 불일치 등을 포괄적으로 포함한다.
    </p>
  
    <p>
      이에 대응하는 선형 ESO는 다음과 같은 형태로 구성된다.
    </p>
  
    $$
    \begin{aligned}
    \hat{T}_{k+1} &= a\hat{T}_k + b u_k + \hat{z}_k
    + L_1 (T_k - \hat{T}_k), \\
    \hat{z}_{k+1} &= \hat{z}_k
    + L_2 (T_k - \hat{T}_k)
    \end{aligned}
    $$
  
    <p>
      여기서 $\hat{T}_k$, $\hat{z}_k$는 각각 추정된 온도 상태와 외란이며,
      $L_1$, $L_2$는 관측기 이득(observer gain)이다.
      ESO는 상태 오차를 기반으로 외란을 실시간으로 보정함으로써,
      모델 기반 제어기의 강건성을 향상시킨다.
    </p>
  
    <p>
      관측기 이득은 확장된 시스템의 관측기 고유값을
      단위원 내부에 배치하는 방식으로 설계되었으며,
      이를 통해 외란 추정의 안정성과 수렴 속도를 확보하였다.
    </p>
  
    <!-- =========================================================
         4.4 MPC Design with ESO-Augmented Model
         ========================================================= -->
    <h3 id="model-predictive--control-formulation">4.4 Model Predictive Control Formulation</h3>
  
    <p>
      ESO를 통해 추정된 외란을 포함한 모델을 기반으로
      이산시간 Model Predictive Control(MPC)을 설계하였다.
      MPC의 예측 모델은 다음과 같이 정의된다.
    </p>
  
    $$
    T_{k+1} = a T_k + b u_k + \hat{z}_k
    $$
  
    <p>
      여기서 $T_k$는 현재 온도,
      $u_k$는 정규화된 제어 입력,
      $a$, $b$는 식별된 ARX 모델 계수,
      $\hat{z}_k$는 ESO를 통해 추정된 외란 항이다.
      외란 항을 예측 모델에 포함함으로써,
      MPC는 모델 불확실성을 능동적으로 보상할 수 있다.
    </p>
  
    <p>
      MPC는 예측 지평 $N$ 동안의 제어 입력 시퀀스를 의사결정 변수로 하여,
      다음과 같은 누적 비용 함수를 최소화한다.
    </p>
  
    $$
    \begin{aligned}
    J = \sum_{i=0}^{N-1}
    \Big(
      \beta (T_{k+i+1} - T^{\mathrm{ref}}_{k+i})^2
      + \lambda (u_{k+i} - u_{k+i-1})^2
      + \eta u_{k+i}^2
    \Big)
    \end{aligned}
    $$
  
    <p>
      비용 함수의 첫 번째 항은 목표 온도 추종 성능을,
      두 번째 항은 입력 변화의 급격함을 억제하기 위한 항이며,
      세 번째 항은 입력 크기를 제한하기 위한 패널티이다.
      가중치 $\beta$, $\lambda$, $\eta$는
      추종 성능과 입력 제약 간의 균형을 고려하여 설정하였다.
    </p>
  
    <p>
      이러한 구조를 통해,
      식별된 단순 모델을 기반으로 하면서도
      외란과 모델 오차에 강인한 MPC 제어기를 구성할 수 있었다.
    </p>
  </section>
  
  <hr>
  
    <!-- =========================================================
         (5) Results
         ========================================================= -->
  <section id="results">
    <h2>5. Results</h2>
  
    <p>
      아래 결과에서는 기존 PID 제어 하에서 수집된 운전 데이터를 기반으로 시스템 식별 및 MPC 설계를 수행하고, 
      이를 통해 설계된 MPC가 기존 PID 제어기를 성공적으로 대체할 수 있는지를 평가한다. 총 6개의 독립적인 데이터셋을 
      사용하여 각각 시스템 식별과 MPC 설계를 수행하였으며, 모ㅗ든 경우에서 정상적인 유사한 결과가 관찰되었다. 이에 따라, 
      아래에서는 대표적 사례인 "250905-A081"에 대해서만 상세한 시각화 결과를 제시하고, 전체 데이터에 대해 성능 개선 효과를 
      정량적 지표를 통해 요약하여 제시한다. 
    </p>
  
    <!-- ========================= -->
    <!-- 5.1 Representative Result -->
    <!-- ========================= -->
    <h3 id="representative-mpc-simulation">5.1 Representative MPC Simulation (데이터 : 250905-A081)</h3>
  
    <p>
      아래에서는 설계된 MPC의 폐루프를 검증하기 위해 대표적인 시뮬레이션 결과를 제시한다. 이를 통해 기준 궤적
      추종 성능, 외란 보상 능력, 오차 수렴 특성, 제어 입력을 시각적으로 검증한다.
    </p>
  
    <!-- Tracking -->
    <figure>
      <img src="./assets/result/tracking_simulation.png" alt="Tracking Simulation">
    </figure>

    <p>
      주황색 선은 목표 온도 궤적을, 파란색 선은 실제 공정 온도를 나타낸다.
      본 공정에서는 허용 오차 ±5~±10 °C 범위 내에서
      930 °C를 약 3시간 유지한 후, 880 °C를 약 1시간 유지하는
      열처리 공정을 MPC를 통해 수행하는 것을 목표로 한다.
      초기 온도에서 시작하여 약 72분 만에 첫 번째 목표 온도인
      930 °C에 수렴하였으며, 이후 목표 온도가 880 °C로 변경된 뒤
      약 267분 시점에서 두 번째 목표 온도에 안정적으로 수렴하였다.
      두 목표 구간을 모두 만족한 후, 전체 열 공정은
      약 326분 시점에서 종료되었음을 확인할 수 있다.
    </p>

  
    <!-- Disturbance -->
    <figure>
      <img src="./assets/result/disturbance.png" alt="Estimated Disturbance">
    </figure>

    <p>
      확장 상태 관측기(ESO)를 통해 추정된 외란 항을 나타낸다.
      온도 목표 전환 구간 및 공정 조건 변화에 따라
      외란 추정값이 적절히 변화하며,
      MPC가 외란을 고려한 제어 입력을 생성할 수 있음을 보여준다.
      특히 목표 온도 변경 구간에서 외란이 급격히 변화함에도 불구하고,
      추정값이 빠르게 수렴하여 안정적인 제어 성능을 유지함을 확인할 수 있다.
    </p>
  
    <!-- Error -->
    <figure>
      <img src="./assets/result/error_state.png" alt="Error State Evolution">
    </figure>

    <p>
      실제 온도와 목표 온도 간의 추종 오차
      \( e = T - T_{\mathrm{ref}} \)의 시간에 따른 변화를 나타낸다.
      초기 구간에서는 큰 오차가 존재하지만,
      MPC 제어 하에서 오차가 빠르게 감소하여
      첫 번째 및 두 번째 목표 온도 구간 모두에서
      오차가 거의 0에 수렴함을 확인할 수 있다.
      이는 폐루프 시스템이 안정적으로 동작하며
      추종 성능이 확보되었음을 의미한다.
    </p>
  
    <!-- Control Input -->
    <figure>
      <img src="./assets/result/control_input.png" alt="Control Input">
    </figure>
  
    <p>
      MPC에 의해 생성된 제어 입력을 나타낸다.
      초기 가열 구간에서는 빠른 온도 상승을 위해
      상대적으로 큰 제어 입력이 적용되며,
      목표 온도 도달 이후에는 입력이 안정적으로 유지된다.
      목표 온도 전환 시 일시적인 입력 변화가 발생하지만,
      과도한 진동이나 포화 없이
      물리적으로 실현 가능한 범위 내에서 제어 입력이 유지됨을 확인할 수 있다.
    </p>
  
    <!-- ========================= -->
    <!-- 5.2 Quantitative Summary  -->
    <!-- ========================= -->
    <h3 id="quantitative-performance-comparison">5.2 Quantitative Performance Comparison (PID vs MPC)</h3>
  
    <p>
      아래에서는 기존 PID 제어기를 MPC로 대체함에 따라
      성능이 얼마나 개선되었는지를 정량적으로 평가한다.
      총 6개의 데이터셋에 대해 성능 지표를 계산하였으며,
      비교 지표로는 공정 수행 길이 감소,
      누적 제어 입력 크기,
      누적 추종 오차,
      그리고 전체 이차 비용 함수를 사용하였다.
      모든 지표에서 MPC 적용 시 일관된 성능 개선이 확인되었다.
    </p>
  
    <div style="overflow-x:auto; margin-top:1em;">
      <table style="
        border-collapse: collapse;
        width: 100%;
        font-size: 0.9em;
        text-align: center;
      ">
        <thead>
          <tr style="background:#f2f2f2;">
            <th rowspan="2">Run ID</th>
            <th colspan="3">공정 길이</th>
            <th colspan="3">제어 입력</th>
            <th colspan="3">추종 오차</th>
            <th colspan="3">비용 함수</th>
          </tr>
          <tr style="background:#f9f9f9;">
            <th>PID</th><th>MPC</th><th>↓ (%)</th>
            <th>PID</th><th>MPC</th><th>↓ (%)</th>
            <th>PID</th><th>MPC</th><th>↓ (%)</th>
            <th>PID</th><th>MPC</th><th>↓ (%)</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>250904-A081</td>
            <td>482</td><td>337</td><td class="rate">43.0</td>
            <td>227.49</td><td>196.48</td><td class="rate">13.6</td>
            <td>2133.22</td><td>1669.99</td><td class="rate">21.7</td>
            <td>9.10e6</td><td>5.58e6</td><td class="rate">38.7</td>
          </tr>
    
          <tr>
            <td>250904-A082</td>
            <td>486</td><td>327</td><td class="rate">48.6</td>
            <td>222.34</td><td>184.96</td><td class="rate">16.8</td>
            <td>1519.72</td><td>1189.27</td><td class="rate">21.7</td>
            <td>4.62e6</td><td>2.83e6</td><td class="rate">38.8</td>
          </tr>
    
          <tr>
            <td>250904-A083</td>
            <td>486</td><td>341</td><td class="rate">42.5</td>
            <td>228.83</td><td>198.65</td><td class="rate">13.2</td>
            <td>2041.85</td><td>1660.69</td><td class="rate">18.7</td>
            <td>8.34e6</td><td>5.52e6</td><td class="rate">33.9</td>
          </tr>
    
          <tr style="background:#eef6ff; font-weight:bold;">
            <td>250905-A081</td>
            <td>488</td><td>326</td><td class="rate">49.7</td>
            <td>232.49</td><td>186.18</td><td class="rate">19.9</td>
            <td>2196.39</td><td>1266.31</td><td class="rate">42.3</td>
            <td>9.65e6</td><td>3.21e6</td><td class="rate">66.8</td>
          </tr>
    
          <tr>
            <td>250907-A081</td>
            <td>500</td><td>348</td><td class="rate">43.7</td>
            <td>249.11</td><td>220.91</td><td class="rate">11.3</td>
            <td>2548.73</td><td>2072.84</td><td class="rate">18.7</td>
            <td>1.30e7</td><td>8.59e6</td><td class="rate">33.9</td>
          </tr>
    
          <tr>
            <td>250907-A082</td>
            <td>496</td><td>336</td><td class="rate">47.6</td>
            <td>232.43</td><td>199.01</td><td class="rate">14.4</td>
            <td>2195.61</td><td>1627.45</td><td class="rate">25.9</td>
            <td>9.64e6</td><td>5.30e6</td><td class="rate">45.1</td>
          </tr>
        </tbody>
      </table>
    </div>
  
    <p>
      정량적 분석 결과, MPC는 모든 데이터셋에서
      기존 PID 제어기 대비 공정 수행 시간 단축,
      제어 입력 사용량 감소,
      추종 오차 감소,
      그리고 전체 비용 함수의 현저한 감소를 달성하였다.
      이는 본 연구에서 설계한 MPC가
      기존 PID 제어기를 안정적이고 효과적으로
      대체할 수 있음을 의미한다.
    </p>
  </section>
        
        
    <!-- =========================================================
         (8) Practical Insights
         ========================================================= -->
    <section id="insights">
      <h2>6. Insights</h2>

      <h3 id="insights-worked">9.1 What Worked Well</h3>
      <p><!-- TODO: 비워둠 --></p>

      <h3 id="insights-issues">9.2 Practical Issues</h3>
      <p><!-- TODO: 비워둠 --></p>

      <h3 id="insights-learned">9.3 Lessons Learned</h3>
      <p><!-- TODO: 비워둠 --></p>
    </section>

    <div class="footer">One-page 논문 스타일 · MathJax · 미디어는 <code>./assets/</code>에 배치</div>
  </div>

  <!-- ===== Last Updated Script ===== -->
  <script>
    (function(){
      const el = document.getElementById('last-updated');
      if(el) el.textContent = 'Last updated: ' + new Date(document.lastModified).toLocaleString();
    })();
  </script>

  <!-- ===== MathJax library (BODY 끝, 반드시 이 위치) ===== -->
  <script
    id="MathJax-script"
    src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
  </script>

</body>
</html>

</html>
